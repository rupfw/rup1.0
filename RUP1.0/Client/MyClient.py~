from socket import *
import sys
import os.path
import json

blksz = 1024

if len(sys.argv) < 2:
	print 'Server Port No. missing in command line arguments'
	serverControlPort = raw_input('Enter Server Port No.: ')
else:
	serverControlPort = sys.argv[1]

serverIP = '127.0.0.1'
clientControlSocket = socket(AF_INET, SOCK_STREAM) 

#Function Start here--
def ReceiveFile(DataPort,filename):
	try:
		clientControlSocket.send(str(DataPort))
		
		ClientDataSocket = socket(AF_INET,SOCK_STREAM) 
		ClientDataSocket.bind(('127.0.0.1',DataPort)) 
		ClientDataSocket.listen(1)
		
		ClientDataConnection, addr = ClientDataSocket.accept()
		clientControlSocket.send("125") # 125: Data connection open; data transfer will start shortly
		filepath = "Client/"+filename
		file = open(filepath, 'wb') # create local file in cwd
		while True:
			data = ClientDataConnection.recv(blksz) # get up to 1K at a time
			if not data: break # till closed on server side
			file.write(data) # store data in local file
		print 'File Received.'	
		if clientControlSocket.recv(1024)=="226":
			print 'Closing Data Connection.'
		ClientDataConnection.close()
		file.close()
		return 0
	except:
		ClientDataConnection.close()
		file.close()
		return -1
#Function end here--

try:
	clientControlSocket.connect((serverIP,int (serverControlPort)))
	file = "\Server\PLT.pdf"; 
	clientControlSocket.send(file)
	ControlConRecv = clientControlSocket.recv(1024) 

	print (ControlConRecv)

	clientControlSocket.close()
except:
	clientControlSocket.close()

